# ============================================================================
# Auto-Agent-Harness: Production Configuration
# ============================================================================
#
# USE THIS FOR: Hardened production deployment
# SECURITY: All security features enabled, strong secrets required
#
# DEPLOYMENT CHECKLIST:
#   [ ] Generate unique JWT_SECRET_KEY (REQUIRED)
#   [ ] Set strong DEFAULT_ADMIN_PASSWORD - 16+ chars (REQUIRED)
#   [ ] Add ANTHROPIC_API_KEY (REQUIRED)
#   [ ] Configure reverse proxy (nginx/traefik) with SSL
#   [ ] Set up SSL/TLS certificates (Let's Encrypt)
#   [ ] Configure firewall (allow only 80/443)
#   [ ] Set up automated backups for WORKSPACE_DIR
#   [ ] Configure log rotation
#   [ ] Set up monitoring/alerting
#
# ============================================================================

# ----------------------------------------------------------------------------
# Claude API Authentication (REQUIRED)
# ----------------------------------------------------------------------------

# Your Anthropic API key
# Get at: https://console.anthropic.com/
# Use a dedicated key for production (not your personal key)
ANTHROPIC_API_KEY=

# ----------------------------------------------------------------------------
# Application Security (REQUIRED - DO NOT SKIP)
# ----------------------------------------------------------------------------

# Always enable authentication in production
AUTH_ENABLED=true

# JWT secret key (REQUIRED)
# Generate: python -c "import secrets; print(secrets.token_hex(32))"
# Store securely, rotate periodically
JWT_SECRET_KEY=

# Admin password (REQUIRED)
# Requirements: 16+ characters, mixed case, numbers, symbols
# Change immediately after first login
DEFAULT_ADMIN_PASSWORD=

# ----------------------------------------------------------------------------
# Paths (Production)
# ----------------------------------------------------------------------------

# Host workspace directory (use absolute path)
# Ensure proper permissions: chown -R 1000:1000 /opt/autocoder/workspace
WORKSPACE_DIR=/opt/autocoder/workspace

# Security: restrict all file operations to workspace
ALLOWED_ROOT_DIRECTORY=/workspace

# Persistent data directory (inside container)
# Mount as named volume for persistence
DATA_DIR=/app/data

# ----------------------------------------------------------------------------
# Network Configuration
# ----------------------------------------------------------------------------

# Bind to all interfaces (reverse proxy handles external access)
HOST=0.0.0.0

# Internal port (reverse proxy maps 443 -> 8888)
PORT=8888

# Allow connections from reverse proxy
# Security is handled by nginx/traefik, not the app
REQUIRE_LOCALHOST=false

# ----------------------------------------------------------------------------
# Monitoring (Recommended)
# ----------------------------------------------------------------------------

# Progress webhook for monitoring dashboard
# PROGRESS_N8N_WEBHOOK_URL=https://your-monitoring.com/webhook/autocoder

# ----------------------------------------------------------------------------
# Production docker-compose.yml overrides (copy to docker-compose.override.yml)
# ----------------------------------------------------------------------------
#
# services:
#   auto-agent-harness:
#     deploy:
#       resources:
#         limits:
#           memory: 4G
#           cpus: '2'
#         reservations:
#           memory: 1G
#     logging:
#       driver: "json-file"
#       options:
#         max-size: "100m"
#         max-file: "5"
#     restart: always
#
# ----------------------------------------------------------------------------
# Nginx configuration (save as /etc/nginx/sites-available/autocoder)
# ----------------------------------------------------------------------------
#
# server {
#     listen 80;
#     server_name autocoder.yourdomain.com;
#     return 301 https://$server_name$request_uri;
# }
#
# server {
#     listen 443 ssl http2;
#     server_name autocoder.yourdomain.com;
#
#     ssl_certificate /etc/letsencrypt/live/autocoder.yourdomain.com/fullchain.pem;
#     ssl_certificate_key /etc/letsencrypt/live/autocoder.yourdomain.com/privkey.pem;
#
#     location / {
#         proxy_pass http://127.0.0.1:8888;
#         proxy_http_version 1.1;
#         proxy_set_header Upgrade $http_upgrade;
#         proxy_set_header Connection "upgrade";
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#         proxy_set_header X-Forwarded-Proto $scheme;
#         proxy_read_timeout 86400;
#     }
# }
#
