{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-10T10:54:04.350Z",
    "slug": "bohuyeshan-apb-document-generation",
    "source_url": "https://github.com/BOHUYESHAN-APB/N-T-AI/tree/main/backend/app/skills/common/document_skill",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "451afd5e9b9f4d3dd5ff586a021b581646838af431d30005ea11f7fdb7bc8fea",
    "tree_hash": "739ee44ea248b1c6c5e4f09a02bbca83a7a5cc8d80515a23f1617591f5f5506e"
  },
  "skill": {
    "name": "document-generation",
    "description": "A powerful skill for generating and processing professional documents (Word, PowerPoint, Excel, PDF).",
    "summary": "A powerful skill for generating and processing professional documents (Word, PowerPoint, Excel, PDF)...",
    "icon": "docs",
    "version": "1.0.0",
    "author": "BOHUYESHAN-APB",
    "license": "MIT",
    "category": "documentation",
    "tags": [
      "document",
      "office",
      "generation",
      "processing"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "filesystem",
      "network"
    ]
  },
  "security_audit": {
    "risk_level": "low",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "Legitimate document generation skill with controlled filesystem access and minimal network usage for fetching images from user-provided URLs only.",
    "risk_factor_evidence": [
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "scripts/excel_generator.py",
            "line_start": 14,
            "line_end": 15
          },
          {
            "file": "scripts/word_generator.py",
            "line_start": 19,
            "line_end": 20
          },
          {
            "file": "scripts/ppt_generator.py",
            "line_start": 25,
            "line_end": 26
          },
          {
            "file": "scripts/pdf_generator.py",
            "line_start": 12,
            "line_end": 13
          },
          {
            "file": "scripts/office_processor.py",
            "line_start": 12,
            "line_end": 13
          }
        ]
      },
      {
        "factor": "network",
        "evidence": [
          {
            "file": "scripts/word_generator.py",
            "line_start": 243,
            "line_end": 248
          },
          {
            "file": "scripts/ppt_generator.py",
            "line_start": 268,
            "line_end": 278
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "title": "Image URL fetching from external sources",
        "description": "The word and PPT generators fetch images from URLs using the requests library. Code at word_generator.py:244-248 and ppt_generator.py:268 makes HTTP GET requests to arbitrary URLs specified by users. An attacker could provide URLs pointing to malicious servers or use file:// URLs to probe internal network paths.",
        "locations": [
          {
            "file": "scripts/word_generator.py",
            "line_start": 243,
            "line_end": 248
          },
          {
            "file": "scripts/ppt_generator.py",
            "line_start": 268,
            "line_end": 278
          }
        ]
      }
    ],
    "dangerous_patterns": [],
    "files_scanned": 7,
    "total_lines": 750,
    "audit_model": "claude",
    "audited_at": "2026-01-10T10:54:04.350Z"
  },
  "content": {
    "user_title": "Generate professional office documents",
    "value_statement": "Manually creating reports, presentations, and spreadsheets takes significant time. This skill automates document generation from HTML content and structured data, producing formatted Word, PowerPoint, Excel, and PDF files in seconds.",
    "seo_keywords": [
      "document generation",
      "Word docx",
      "PowerPoint pptx",
      "Excel xlsx",
      "PDF creation",
      "office documents",
      "Claude",
      "Codex",
      "Claude Code"
    ],
    "actual_capabilities": [
      "Generate Word documents with headings, paragraphs, lists, and tables from HTML",
      "Create PowerPoint presentations with themes, images, tables, and charts",
      "Build Excel spreadsheets from structured data lists",
      "Convert HTML content to formatted PDF documents",
      "Extract text from existing PDF files",
      "Convert Markdown to HTML for document processing"
    ],
    "limitations": [
      "Requires Python libraries: python-docx, python-pptx, openpyxl, reportlab, pypdf",
      "Images must be accessible via local path or HTTP URL",
      "PDF generation depends on WeasyPrint installation",
      "Complex formatting may require manual adjustment after generation"
    ],
    "use_cases": [
      {
        "target_user": "Technical writers",
        "title": "Auto-generate documentation",
        "description": "Convert Markdown or HTML documentation into formatted Word and PDF reports automatically."
      },
      {
        "target_user": "Business analysts",
        "title": "Create presentation decks",
        "description": "Transform data summaries and analysis into PowerPoint slides with charts and visualizations."
      },
      {
        "target_user": "Data professionals",
        "title": "Export data to spreadsheets",
        "description": "Convert lists and dictionaries into properly formatted Excel workbooks for reporting."
      }
    ],
    "prompt_templates": [
      {
        "title": "Simple Word report",
        "scenario": "Generate a basic Word document",
        "prompt": "Generate a Word document named 'report.docx' with a heading 'Project Status' and a paragraph summarizing that all tasks are complete."
      },
      {
        "title": "Presentation slides",
        "scenario": "Create a PowerPoint presentation",
        "prompt": "Create a PowerPoint with two slides. The first slide should have the title 'Quarterly Review'. The second slide should have the title 'Results' with bullet points showing revenue growth, new customers, and market expansion."
      },
      {
        "title": "Data spreadsheet",
        "scenario": "Build an Excel file",
        "prompt": "Generate an Excel file named 'budget.xlsx' with columns for Category, Expected, and Actual, containing three rows for Software, Marketing, and Office Supplies."
      },
      {
        "title": "PDF document",
        "scenario": "Convert content to PDF",
        "prompt": "Convert this HTML content to a PDF file named 'summary.pdf': '<h1>Executive Summary</h1><p>The project was completed successfully with all milestones achieved.</p>'"
      }
    ],
    "output_examples": [
      {
        "input": "Generate a Word document named 'meeting_notes.docx' with a heading 'Team Meeting' and a paragraph summarizing Q1 planning results.",
        "output": [
          "Created: /generated_docs/word/meeting_notes_20260110-120000.docx",
          "Format: DOCX with proper heading styling",
          "Content: Team Meeting heading + Q1 planning summary paragraph"
        ]
      }
    ],
    "best_practices": [
      "Provide well-structured HTML with semantic tags for best formatting results",
      "Use CSS color codes in hex format (#RRGGBB) for consistent styling in Word documents",
      "Test with small documents first before generating large reports",
      "Ensure image URLs are publicly accessible when using web-hosted images"
    ],
    "anti_patterns": [
      "Embedding malicious URLs in image src attributes to probe internal networks",
      "Using untrusted HTML content that could contain exploit attempts",
      "Generating documents to system directories outside the project scope",
      "Processing sensitive PDFs without verifying the source content"
    ],
    "faq": [
      {
        "question": "What document formats are supported?",
        "answer": "Word (.docx), PowerPoint (.pptx), Excel (.xlsx), and PDF files are supported for both generation and processing."
      },
      {
        "question": "What are the file size limits?",
        "answer": "Document size limits depend on available memory. For large documents, consider processing in smaller chunks to avoid memory issues."
      },
      {
        "question": "Can this skill integrate with cloud storage?",
        "answer": "The skill writes files to local directories. Integration with cloud storage requires additional setup using platform-specific tools."
      },
      {
        "question": "Is my data safe when processing documents?",
        "answer": "All processing happens locally on your machine. No document content is sent to external servers except when you provide image URLs."
      },
      {
        "question": "Why are my images not appearing in the output?",
        "answer": "Images must be accessible via local file path or HTTP URL. Check that URLs are publicly accessible and file paths are correct."
      },
      {
        "question": "How does this compare to manual document creation?",
        "answer": "This skill automates repetitive formatting tasks. Complex design work still benefits from manual tools, but generation saves significant time for standard documents."
      }
    ]
  },
  "file_structure": [
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "__init__.py",
          "type": "file",
          "path": "scripts/__init__.py"
        },
        {
          "name": "excel_generator.py",
          "type": "file",
          "path": "scripts/excel_generator.py"
        },
        {
          "name": "office_processor.py",
          "type": "file",
          "path": "scripts/office_processor.py"
        },
        {
          "name": "pdf_generator.py",
          "type": "file",
          "path": "scripts/pdf_generator.py"
        },
        {
          "name": "ppt_generator.py",
          "type": "file",
          "path": "scripts/ppt_generator.py"
        },
        {
          "name": "word_generator.py",
          "type": "file",
          "path": "scripts/word_generator.py"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
