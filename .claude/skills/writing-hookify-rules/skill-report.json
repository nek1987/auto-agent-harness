{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-11T07:24:31.807Z",
    "slug": "anthropics-writing-hookify-rules",
    "source_url": "https://github.com/anthropics/claude-plugins-official/tree/main/plugins/hookify/skills/writing-rules",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "3.0.0",
    "source_type": "community",
    "content_hash": "a084a1868d4d9431d6b6f7845a5695e73bd0aafa9faf7ffff6c7dd5a81cbb693",
    "tree_hash": "6f9cfd729fa47600e6c572a1df0342b9b8990942eade010a136dbbafe5432a5b"
  },
  "skill": {
    "name": "Writing Hookify Rules",
    "description": "This skill should be used when the user asks to \"create a hookify rule\", \"write a hook rule\", \"configure hookify\", \"add a hookify rule\", or needs guidance on hookify rule syntax and patterns.",
    "summary": "This skill should be used when the user asks to \"create a hookify rule\", \"write a hook rule\", \"confi...",
    "icon": "ü™ù",
    "version": "0.1.0",
    "author": "anthropics",
    "license": "MIT",
    "category": "security",
    "tags": [
      "hookify",
      "rules",
      "pattern-matching",
      "security",
      "safety"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "scripts",
      "external_commands",
      "env_access"
    ]
  },
  "security_audit": {
    "risk_level": "safe",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "All 156 static findings are FALSE POSITIVES. This skill is documentation-only, teaching users how to write Hookify rules that DETECT dangerous patterns like eval(), rm -rf, and chmod 777. The 'dangerous' strings appear only as regex patterns to match, never as executed code. The skill's purpose is defensive security education.",
    "risk_factor_evidence": [
      {
        "factor": "scripts",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 249,
            "line_end": 249
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 11,
            "line_end": 11
          }
        ]
      },
      {
        "factor": "env_access",
        "evidence": [
          {
            "file": "SKILL.md",
            "line_start": 79,
            "line_end": 79
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [],
    "dangerous_patterns": [],
    "files_scanned": 1,
    "total_lines": 375,
    "audit_model": "claude",
    "audited_at": "2026-01-11T07:24:31.807Z"
  },
  "content": {
    "user_title": "Create Hookify Rules for Claude Safety",
    "value_statement": "Developers need to prevent dangerous patterns like eval(), rm -rf, and secret exposure in Claude workflows. This skill teaches you to write Hookify rules that detect and block risky commands and code edits before they execute.",
    "seo_keywords": [
      "hookify rules",
      "claude code safety",
      "pattern matching",
      "security rules",
      "dangerous command detection",
      "claude security",
      "codex hookify",
      "prevent risky commands",
      "file edit safety",
      "regex patterns"
    ],
    "actual_capabilities": [
      "Create Hookify rule files with YAML frontmatter and regex patterns",
      "Define rules for bash commands like rm -rf, chmod 777, and sudo",
      "Build multi-condition rules for file edits detecting secrets and risky code",
      "Configure event types including bash, file, stop, and prompt events",
      "Write effective regex patterns for precise pattern matching",
      "Organize rules with descriptive names and proper file structure"
    ],
    "limitations": [
      "Rules apply only to Claude sessions with Hookify enabled",
      "Pattern matching is regex-based and requires proper escaping",
      "Rules cannot prevent all dangerous operations without proper configuration",
      "Block actions only work during PreToolUse events"
    ],
    "use_cases": [
      {
        "target_user": "Security-conscious developers",
        "title": "Block dangerous commands",
        "description": "Prevent rm -rf, chmod 777, and other risky bash commands from executing in production environments."
      },
      {
        "target_user": "Team leads",
        "title": "Enforce code quality",
        "description": "Warn about console.log statements, eval() calls, and other problematic patterns before they enter the codebase."
      },
      {
        "target_user": "DevOps engineers",
        "title": "Protect sensitive files",
        "description": "Detect and block attempts to edit .env files, credentials, and certificate files in non-compliant ways."
      }
    ],
    "prompt_templates": [
      {
        "title": "Basic rule creation",
        "scenario": "Create a Hookify rule",
        "prompt": "Create a Hookify rule to warn about console.log statements in JavaScript files."
      },
      {
        "title": "Dangerous command rule",
        "scenario": "Block rm commands",
        "prompt": "Write a Hookify rule that blocks rm -rf commands in the bash event."
      },
      {
        "title": "Multi-condition rule",
        "scenario": "Detect secret exposure",
        "prompt": "Create a rule that detects when someone adds API_KEY to .env files in the project root."
      },
      {
        "title": "Completion checklist",
        "scenario": "Enforce workflow steps",
        "prompt": "Write a Hookify stop event rule that reminds me to run tests before completing a task."
      }
    ],
    "output_examples": [
      {
        "input": "Create a Hookify rule to warn about dangerous bash commands",
        "output": [
          "Created: .claude/hookify.dangerous-bash.local.md",
          "",
          "Rule Configuration:",
          "- Event: bash",
          "- Action: warn",
          "- Pattern: rm\\s+-rf|chmod\\s+777|sudo\\s+",
          "",
          "This rule triggers on:",
          "- rm -rf /path (with any whitespace)",
          "- chmod 777 permissions",
          "- sudo commands",
          "",
          "Claude will see a warning message before these commands execute."
        ]
      }
    ],
    "best_practices": [
      "Use specific regex patterns to minimize false positives in your rules",
      "Test patterns against real commands before deploying rules",
      "Add rules to .gitignore to prevent committing project-specific safety configurations"
    ],
    "anti_patterns": [
      "Using overly broad patterns like 'rm' that match legitimate commands",
      "Creating block rules without testing patterns first",
      "Storing Hookify rules in version control without .gitignore"
    ],
    "faq": [
      {
        "question": "What are Hookify rules?",
        "answer": "Hookify rules are markdown files that define patterns to detect and responses to show when Claude uses tools matching those patterns."
      },
      {
        "question": "How do I create a Hookify rule?",
        "answer": "Create a .md file in .claude/ with YAML frontmatter containing name, enabled, event, and pattern fields, followed by a message."
      },
      {
        "question": "What events can Hookify rules respond to?",
        "answer": "Rules can respond to bash commands, file edits, stop events, prompt events, or all events combined."
      },
      {
        "question": "What is the difference between warn and block actions?",
        "answer": "Warn shows a message but allows the operation. Block prevents the operation entirely during PreToolUse events."
      },
      {
        "question": "How do I test Hookify patterns?",
        "answer": "Use Python regex matching or online testers like regex101.com with Python flavor to verify your patterns match correctly."
      },
      {
        "question": "Where should I store Hookify rules?",
        "answer": "Store rules in .claude/ directory with .local.md suffix and add them to .gitignore for project-specific configurations."
      }
    ]
  },
  "file_structure": [
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
