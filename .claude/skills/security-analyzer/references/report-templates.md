# Report Templates

## Technical Report Structure

```markdown
# Security Analysis Report
**Generated:** {timestamp}  
**Scope:** {scan_root}

## Executive Summary
- **Total Vulnerabilities:** {count}
- **Critical:** {critical} | **High:** {high} | **Medium:** {medium} | **Low:** {low}
- **Secrets Exposure Risk:** {risk_level}

## Environment Inventory
- Dependencies: {dep_count} packages across {ecosystems}
- Containers: {container_count} configurations
- Cloud Resources: {cloud_count} IaC files

---

## Phase 1: Critical Priority

### {CVE-ID}: {summary}
**Risk Score:** {score}/10  
**Package:** {package}@{version}  
**CVSS:** {cvss} ({level})  
**Exploitability:** {exploitability_reason}

#### Vulnerability Details
{details}

#### Affected Versions
- Introduced: {introduced}
- Fixed in: {fixed_version}

#### Remediation

**Fix Command:**
```bash
{fix_command}
```

**Code Patch:**
```diff
{patch_diff}
```

#### Validation Tests

**Pre-fix test (should PASS before fix):**
```python
def test_{cve_id}_exists():
    # Proves vulnerability is present
    {pre_test_code}
```

**Remediation unit test:**
```python
def test_{cve_id}_fix_logic():
    # Tests the fix code works correctly
    {fix_test_code}
```

**Post-fix test (should PASS after fix):**
```python
def test_{cve_id}_resolved():
    # Proves vulnerability is fixed
    {post_test_code}
```

---

## Phase 2: High Priority
{repeat structure}

---

## Phase 3: Medium Priority
{repeat structure}

---

## Phase 4: Low Priority
{repeat structure}

---

## Additional Findings

### Secrets Exposure
{secrets_findings}

### Container Security
{container_findings}

### Infrastructure Misconfigurations
{iac_findings}

---

## Remediation Checklist
- [ ] Phase 1: {critical_count} critical items
- [ ] Phase 2: {high_count} high items
- [ ] Phase 3: {medium_count} medium items
- [ ] Phase 4: {low_count} low items
- [ ] Run all validation tests
- [ ] Update security documentation
```

## Executive Report Structure

```markdown
# Security Assessment Summary
**Date:** {date}  
**Prepared for:** Leadership Review

## Overall Security Posture
**Risk Level:** {overall_risk}

## Key Findings

| Priority | Count | Estimated Effort |
|----------|-------|------------------|
| Critical | {n}   | {hours} hours    |
| High     | {n}   | {hours} hours    |
| Medium   | {n}   | {hours} hours    |
| Low      | {n}   | {hours} hours    |

## Top 5 Risks

1. **{title}** - {one_line_impact}
2. **{title}** - {one_line_impact}
3. **{title}** - {one_line_impact}
4. **{title}** - {one_line_impact}
5. **{title}** - {one_line_impact}

## Recommended Actions

### Immediate (This Week)
- {action_1}
- {action_2}

### Short-term (This Month)
- {action_3}
- {action_4}

### Long-term (This Quarter)
- {action_5}

## Resource Requirements
- Engineering time: ~{hours} hours
- External tools/services: {list}
- Training needs: {list}

## Compliance Impact
{compliance_notes}
```

## Test File Structure

```python
# test_security_validations.py
"""
Security validation tests for {project_name}
Generated by security-analyzer

Run: pytest test_security_validations.py -v
"""

import subprocess
import json
import re

class TestPhase1Critical:
    """Critical vulnerability validations."""
    
    def test_{cve_normalized}_vulnerable_before_fix(self):
        """Vulnerability {CVE-ID} - SHOULD PASS BEFORE FIX."""
        # Check if vulnerable version is installed
        {detection_code}
        assert is_vulnerable, "Expected vulnerable version"
    
    def test_{cve_normalized}_fixed_after_remediation(self):
        """Vulnerability {CVE-ID} - SHOULD PASS AFTER FIX."""
        # Check if patched version is installed
        {verification_code}
        assert not is_vulnerable, "Vulnerability still present"


class TestPhase2High:
    """High priority vulnerability validations."""
    {repeat}


class TestRemediationLogic:
    """Unit tests for remediation code."""
    
    def test_version_bump_logic(self):
        """Test that version bump produces valid package.json."""
        {test_code}
    
    def test_config_patch_valid(self):
        """Test that config patches are syntactically valid."""
        {test_code}
```
