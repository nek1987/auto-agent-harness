{
  "schema_version": "2.0",
  "meta": {
    "generated_at": "2026-01-10T12:33:09.468Z",
    "slug": "cornjebus-security-analyzer",
    "source_url": "https://github.com/Cornjebus/security-analyzer/tree/main/.claude/skills/security-analyzer",
    "source_ref": "main",
    "model": "claude",
    "analysis_version": "2.0.0",
    "source_type": "community",
    "content_hash": "54f1e90d87b0ecdb321889b767583300510434790a73121a0d06979013656619",
    "tree_hash": "e72ad447b5b15fd5ed2183a10ced09eed73af135d34b85771b5c8e25b7e3d4bd"
  },
  "skill": {
    "name": "security-analyzer",
    "description": "Comprehensive security vulnerability analysis for codebases and infrastructure. Scans dependencies (npm, pip, gem, go, cargo), containers (Docker, Kubernetes), cloud IaC (Terraform, CloudFormation), and detects secrets exposure. Fetches live CVE data from OSV.dev, calculates risk scores, and generates phased remediation plans with TDD validation tests. Use when users mention security scan, vulnerability, CVE, exploit, security audit, penetration test, OWASP, hardening, dependency audit, container security, or want to improve security posture.",
    "summary": "Comprehensive security vulnerability analysis for codebases and infrastructure. Scans dependencies (...",
    "icon": "ðŸ”’",
    "version": "1.0.0",
    "author": "Cornjebus",
    "license": "MIT",
    "category": "security",
    "tags": [
      "vulnerability scanning",
      "CVE detection",
      "dependency audit",
      "container security",
      "infrastructure as code"
    ],
    "supported_tools": [
      "claude",
      "codex",
      "claude-code"
    ],
    "risk_factors": [
      "filesystem",
      "network",
      "external_commands"
    ]
  },
  "security_audit": {
    "risk_level": "medium",
    "is_blocked": false,
    "safe_to_publish": true,
    "summary": "This is a legitimate security scanning skill with expected capabilities for its purpose. Filesystem access is scoped to project files (excludes node_modules/.git), network access is limited to OSV.dev API, and test code generation uses subprocess only for version detection. The skill does NOT access credentials, ssh keys, or AWS credentials. Risk is elevated due to broad project access which is necessary for its stated security scanning purpose.",
    "risk_factor_evidence": [
      {
        "factor": "filesystem",
        "evidence": [
          {
            "file": "scripts/discover_env.py",
            "line_start": 14,
            "line_end": 20
          },
          {
            "file": "scripts/discover_env.py",
            "line_start": 98,
            "line_end": 122
          }
        ]
      },
      {
        "factor": "network",
        "evidence": [
          {
            "file": "scripts/fetch_vulns.py",
            "line_start": 14,
            "line_end": 14
          },
          {
            "file": "scripts/fetch_vulns.py",
            "line_start": 40,
            "line_end": 50
          }
        ]
      },
      {
        "factor": "external_commands",
        "evidence": [
          {
            "file": "scripts/generate_report.py",
            "line_start": 50,
            "line_end": 61
          },
          {
            "file": "scripts/generate_report.py",
            "line_start": 73,
            "line_end": 85
          }
        ]
      }
    ],
    "critical_findings": [],
    "high_findings": [],
    "medium_findings": [],
    "low_findings": [
      {
        "title": "Test generation includes subprocess calls",
        "description": "The report generator creates test code containing subprocess.run() calls to detect package versions. Lines 50-61 show pip subprocess usage for version detection. This is a legitimate pattern for vulnerability testing but involves code execution. An attacker could theoretically manipulate inventory files to inject malicious commands, though this would require existing write access to the project.",
        "locations": [
          {
            "file": "scripts/generate_report.py",
            "line_start": 50,
            "line_end": 85
          }
        ]
      }
    ],
    "dangerous_patterns": [],
    "files_scanned": 5,
    "total_lines": 1084,
    "audit_model": "claude",
    "audited_at": "2026-01-10T12:33:09.468Z"
  },
  "content": {
    "user_title": "Scan projects for security vulnerabilities",
    "value_statement": "Developers need to identify security risks in their codebases before deployment. This skill scans dependencies, containers, and cloud infrastructure for vulnerabilities, fetches live CVE data, and generates fix commands with validation tests.",
    "seo_keywords": [
      "security scanner",
      "vulnerability scan",
      "CVE detection",
      "dependency audit",
      "OWASP",
      "security audit",
      "Claude Code",
      "container security",
      "IaC security",
      "secret detection"
    ],
    "actual_capabilities": [
      "Scan dependencies across npm, pip, gem, Go, and Cargo ecosystems",
      "Detect exposed .env files and secrets exposure risks",
      "Find Docker, Kubernetes, Terraform, and CloudFormation configurations",
      "Query OSV.dev API for real-time CVE vulnerability data",
      "Calculate risk scores using CVSS, exploitability, and exposure factors",
      "Generate remediation plans with fix commands and TDD validation tests"
    ],
    "limitations": [
      "Does not perform dynamic analysis or runtime security testing",
      "Requires network access to fetch CVE data from OSV.dev",
      "Risk scoring uses default assumptions that may need manual adjustment",
      "Does not access private vulnerability databases or enterprise security tools"
    ],
    "use_cases": [
      {
        "target_user": "DevOps Engineers",
        "title": "Container security audits",
        "description": "Scan Dockerfiles and Kubernetes manifests for misconfigurations and known vulnerabilities in base images."
      },
      {
        "target_user": "Security Teams",
        "title": "Vulnerability assessments",
        "description": "Run comprehensive dependency audits with CVE data, risk scores, and prioritized remediation plans."
      },
      {
        "target_user": "Developers",
        "title": "Pre-commit security checks",
        "description": "Identify secrets exposure and dependency vulnerabilities before pushing code to version control."
      }
    ],
    "prompt_templates": [
      {
        "title": "Quick security scan",
        "scenario": "Basic vulnerability check",
        "prompt": "Run a security scan on this project using the security-analyzer skill. Show me the critical and high severity vulnerabilities."
      },
      {
        "title": "Container audit",
        "scenario": "Docker and K8s review",
        "prompt": "Check this project for container security issues. Focus on Dockerfile base images and Kubernetes configuration risks."
      },
      {
        "title": "Secrets scan",
        "scenario": "Credential exposure check",
        "prompt": "Look for potentially exposed secrets in this codebase. Check .env files and suggest remediation steps."
      },
      {
        "title": "Full assessment",
        "scenario": "Complete security report",
        "prompt": "Perform a complete security analysis including dependency vulnerabilities, container configs, cloud IaC, and secrets exposure. Generate both technical and executive reports."
      }
    ],
    "output_examples": [
      {
        "input": "Run a security scan on this project",
        "output": [
          "Found 23 dependencies across npm (18), pip (3), and Go (2)",
          "Identified 5 vulnerabilities: 1 Critical, 2 High, 2 Medium",
          "Critical: CVE-2024-37890 in library@1.0.0 (CVSS 9.8)",
          "Secrets exposure risk: 2 .env files potentially committed",
          "Generated fix commands and validation tests for all findings"
        ]
      }
    ],
    "best_practices": [
      "Run security scans early in development and before each release",
      "Address critical and high severity vulnerabilities within your SLA",
      "Review and rotate any secrets that may have been exposed",
      "Integrate the security analyzer into CI/CD pipelines for automated scanning"
    ],
    "anti_patterns": [
      "Ignoring low severity findings without review",
      "Running scans only after production deployment",
      "Not validating fixes with the generated test cases",
      "Skipping secrets exposure checks after finding .env files"
    ],
    "faq": [
      {
        "question": "Which package ecosystems are supported?",
        "answer": "npm, pip, RubyGems, Go modules, and Cargo crates are fully supported. Maven and NuGet can be queried through OSV.dev."
      },
      {
        "question": "What severity levels are used?",
        "answer": "Critical (CVSS 9.0+), High (CVSS 7.0-8.9), Medium (CVSS 4.0-6.9), and Low (CVSS below 4.0). Scores are combined with exploitability factors."
      },
      {
        "question": "How does it integrate with my workflow?",
        "answer": "The skill uses standard Claude tools (Bash, Read, Write) to scan your project. It outputs JSON reports that you can save or convert to markdown documentation."
      },
      {
        "question": "Is my code and data safe?",
        "answer": "Yes. The skill only reads project files and never logs secrets or credentials. Network access is limited to the OSV.dev public API. No data is sent to third parties."
      },
      {
        "question": "Why did the scan find no vulnerabilities?",
        "answer": "Either all dependencies are up to date, the OSV.dev API was unreachable, or the ecosystem is not yet fully mapped. Try WebSearch for CISA KEV data for actively exploited vulns."
      },
      {
        "question": "How is this different from npm audit?",
        "answer": "This skill provides unified scanning across all ecosystems, adds risk scoring, generates fix commands with tests, and creates executive summaries for leadership reporting."
      }
    ]
  },
  "file_structure": [
    {
      "name": "references",
      "type": "dir",
      "path": "references",
      "children": [
        {
          "name": "report-templates.md",
          "type": "file",
          "path": "references/report-templates.md"
        }
      ]
    },
    {
      "name": "scripts",
      "type": "dir",
      "path": "scripts",
      "children": [
        {
          "name": "discover_env.py",
          "type": "file",
          "path": "scripts/discover_env.py"
        },
        {
          "name": "fetch_vulns.py",
          "type": "file",
          "path": "scripts/fetch_vulns.py"
        },
        {
          "name": "generate_report.py",
          "type": "file",
          "path": "scripts/generate_report.py"
        }
      ]
    },
    {
      "name": "SKILL.md",
      "type": "file",
      "path": "SKILL.md"
    }
  ]
}
